# Fly.io configuration for maisUI application
# Deploy with: flyctl deploy

app = "maisui"
primary_region = "yul"  # Montreal region (closest to Quebec)

[build]
  dockerfile = "Dockerfile"

[env]
  GRADIO_SERVER_NAME = "0.0.0.0"
  GRADIO_SERVER_PORT = "8080"

[http_service]
  internal_port = 8080
  force_https = true
  auto_stop_machines = true
  auto_start_machines = true
  min_machines_running = 0
  processes = ["app"]

  [[http_service.checks]]
    grace_period = "60s"
    interval = "30s"
    method = "GET"
    timeout = "10s"
    path = "/"

# Resource allocation
# Adjust based on model size
[[vm]]
  cpu_kind = "shared"
  cpus = 2
  memory_mb = 2048

# Persistent storage for model files (optional)
# Uncomment if you want to store models in persistent volume
# [[mounts]]
#   source = "model_data"
#   destination = "/app/models"
#   initial_size = "10GB"

# Secrets (set with: flyctl secrets set KEY=VALUE)
# MODEL_PATH=/app/models/model.keras
# PREPROCESSOR_PATH=/app/models/preprocessor.pkl
